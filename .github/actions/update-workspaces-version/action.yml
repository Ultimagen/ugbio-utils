 
name: "Update workspaces version"
description: "Update version in pyproject.toml in all workspaces and commit changes"

inputs:
 version:
    description: "new version"
    required: true
 github-token:
    description: "github-token"
    required: true

runs:
  using: "composite"


  steps:
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      shell: bash
      run: pip install tomli_w

    - name: Update pyproject.toml files with new dev_version
      shell: bash
      run: python .github/utils/update_project_version.py ${{ inputs.version }}

    - name: Commit and push changes
      env:
        GITHUB_TOKEN: ${{ inputs.github-token }}
      uses: EndBug/add-and-commit@v9
      with:
        add: "."
        message: Update pyproject.toml versions to ${{ inputs.version }}
        committer_name: GitHub Actions
        committer_email: actions@github.com